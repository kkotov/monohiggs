for(i in c(-1:3, 9))  print(switch(i, 1, 2 , 3, 4))
for(i in c(-1:3, 9))  print(switch(i, 10, 20 , 30, 40))
hj0pt <- function(entry){ switch(entry[["hJidx.0."]]+1, entry[["Jet_pt.0."]],  entry[["Jet_pt.1."]],  entry[["Jet_pt.2."]] )  }
hj0pt <- function(entry){ switch(entry[["hJidx.0."]]+1, entry[["Jet_pt.0."]],  entry[["Jet_pt.1."]],  entry[["Jet_pt.2."]] )  }
hj1pt <- function(entry){ switch(entry[["hJidx.1."]]+1, entry[["Jet_pt.0."]],  entry[["Jet_pt.1."]],  entry[["Jet_pt.2."]] )  }
hj0eta<- function(entry){ switch(entry[["hJidx.0."]]+1, entry[["Jet_eta.0."]], entry[["Jet_eta.1."]], entry[["Jet_eta.2."]] ) }
hj1eta<- function(entry){ switch(entry[["hJidx.1."]]+1, entry[["Jet_eta.0."]], entry[["Jet_eta.1."]], entry[["Jet_eta.2."]] ) }
select <- function(event){ hj0pt(event)>50 & hj1pt(event)>50 & abs(hj0eta(event))<2.1 & abs(hj1eta(event))<2.1 }
head( apply(data[1:6,],1,hj1pt) )
class( data[["hJidx.1."]] )
cls <- function(entry){ entry[["hJidx.0."]] }
head( apply(data[1:6,],1,cls) )
cls <- function(entry){ as.integral(entry[["hJidx.0."]]) }
head( apply(data[1:6,],1,cls) )
cls <- function(entry){ as.integer(entry[["hJidx.0."]]) }
head( apply(data[1:6,],1,cls) )
hj0pt <- function(entry){ switch(as.integer(entry[["hJidx.0."]])+1, entry[["Jet_pt.0."]],  entry[["Jet_pt.1."]],  entry[["Jet_pt.2."]] )  }
hj1pt <- function(entry){ switch(as.integer(entry[["hJidx.1."]])+1, entry[["Jet_pt.0."]],  entry[["Jet_pt.1."]],  entry[["Jet_pt.2."]] )  }
hj0eta<- function(entry){ switch(as.integer(entry[["hJidx.0."]])+1, entry[["Jet_eta.0."]], entry[["Jet_eta.1."]], entry[["Jet_eta.2."]] ) }
hj1eta<- function(entry){ switch(as.integer(entry[["hJidx.1."]])+1, entry[["Jet_eta.0."]], entry[["Jet_eta.1."]], entry[["Jet_eta.2."]] ) }
select<- function(event){ hj0pt(event)>50 & hj1pt(event)>50 & abs(hj0eta(event))<2.1 & abs(hj1eta(event))<2.1 }
head( apply(data[1:6,],1,hj0pt) )
head( apply(data[1:6,],1,hj1pt) )
head( data[["hJidx.1."]] )
head( apply(data[1:6,],1,hj1eta) )
head( apply(data[1:6,],1,hj0eta) )
head( apply(data[4:6,],1,hj1eta) )
head( apply(data[3:6,],1,hj1eta) )
head( apply(data[3:6,],1,select) )
select<- function(event){ as.numeric(hj0pt(event))>50 & as.numeric(hj1pt(event))>50 & abs(as.numeric(hj0eta(event)))<2.1 & abs(as.numeric(hj1eta(event)))<2.1 }
head( apply(data[3:6,],1,select) )
head( apply(data[4:6,],1,select) )
select<- function(event){ event[["hJidx.0."]] < 3 & as.numeric(hj0pt(event))>50 & as.numeric(hj1pt(event))>50 & abs(as.numeric(hj0eta(event)))<2.1 & abs(as.numeric(hj1eta(event)))<2.1 }
head( apply(data[4:6,],1,select) )
head( apply(data[3:6,],1,select) )
d <- subset(data,hJidx.0.<3 & hJidx.1.<3)
head(d)
head( apply(d[3:6,],1,select) )
d$sel <- apply(d,1,select)
head(d$sel)
ggplot(data=subset(d,sel=T),aes(x=met_pt,weight=genWeight)) + geom_histogram(breaks=seq(150,300,10),aes(color=sample,fill=sample)) + theme(title=element_text(size=20), axis.title.x = element_text(size=20), axis.text.x=element_text(size=15)) + labs(x=expression(paste(E[T] ^{miss},"(GeV)")),y=expression(paste("# of events weighted to 20 ",fb^{-1})),title="All samples") + theme(legend.position=c(0.85,0.8),  legend.text=element_text(size=15), legend.background = element_rect(fill=alpha('white',0.00001)))
ggplot(data=data,aes(x=met_pt,weight=genWeight)) + geom_histogram(breaks=seq(150,300,10),aes(color=sample,fill=sample)) + theme(title=element_text(size=20), axis.title.x = element_text(size=20), axis.text.x=element_text(size=15)) + labs(x=expression(paste(E[T] ^{miss},"(GeV)")),y=expression(paste("# of events weighted to 20 ",fb^{-1})),title="All samples") + theme(legend.position=c(0.85,0.8),  legend.text=element_text(size=15), legend.background = element_rect(fill=alpha('white',0.00001)))
dev.copy(svg,"qwe.svg")
dev.off()
ggplot(data=subset(d,sel=T),aes(x=met_pt,weight=genWeight)) + geom_histogram(breaks=seq(150,300,10),aes(color=sample,fill=sample)) + theme(title=element_text(size=20), axis.title.x = element_text(size=20), axis.text.x=element_text(size=15)) + labs(x=expression(paste(E[T] ^{miss},"(GeV)")),y=expression(paste("# of events weighted to 20 ",fb^{-1})),title="All samples") + theme(legend.position=c(0.85,0.8),  legend.text=element_text(size=15), legend.background = element_rect(fill=alpha('white',0.00001)))
head(data)
qplot(data$nhJidx)
qplot(data$nhJCidx)
qplot(data$nhJidx_sortcsv)
library(ggplot2)
#qcd     <- read.csv(file='Step3_QCD.csv',      header=T,sep=',')
qcd100  <- read.csv(file='Step3_QCDHT100.csv', header=T,sep=',')
qcd250  <- read.csv(file='Step3_QCDHT250.csv', header=T,sep=',')
qcd500  <- read.csv(file='Step3_QCDHT500.csv', header=T,sep=',')
qcd1000 <- read.csv(file='Step3_QCDHT1000.csv',header=T,sep=',')
t_t     <- read.csv(file='Step3_T_t.csv',      header=T,sep=',')
tbar_t  <- read.csv(file='Step3_Tbar_t.csv',   header=T,sep=',')
t_tw    <- read.csv(file='Step3_T_tW.csv',     header=T,sep=',')
tbar_tw <- read.csv(file='Step3_Tbar_tW.csv',  header=T,sep=',')
t_s     <- read.csv(file='Step3_T_s.csv',      header=T,sep=',')
tbar_s  <- read.csv(file='Step3_Tbar_s.csv',   header=T,sep=',')
wjets   <- read.csv(file='Step3_WJets.csv',    header=T,sep=',')
ttp     <- read.csv(file='Step3_TTPythia8.csv',header=T,sep=',')
hznn    <- read.csv(file='Step3_ZnnH125.csv',  header=T,sep=',')
#zj      <- read.csv(file='Step3_ZJets.csv',    header=T,sep=',')
zj100   <- read.csv(file='Step3_ZJetsHT100.csv',header=T,sep=',')
zj200   <- read.csv(file='Step3_ZJetsHT200.csv',header=T,sep=',')
zj600   <- read.csv(file='Step3_ZJetsHT600.csv',header=T,sep=',')
wjInc   <- read.csv(file='Step3_WJetsIncl.csv',header=T,sep=',')
wj100   <- read.csv(file='Step3_WJetsHT100.csv',header=T,sep=',')
wj200   <- read.csv(file='Step3_WJetsHT200.csv',header=T,sep=',')
wj400   <- read.csv(file='Step3_WJetsHT400.csv',header=T,sep=',')
wh      <- read.csv(file='Step3_WlnH125.csv',   header=T,sep=',')
monoH   <- read.csv(file='Step3_monoH.csv',     header=T,sep=',')
qcd100$xsec = 28730000.
qcd100$genWeight = 28730000. / 4123591.
qcd250$xsec = 670500.
qcd250$genWeight = 670500. / 2668164.
qcd500$xsec = 26740.
qcd500$genWeight = 26740. / 4063331.
qcd1000$xsec = 769.7
qcd1000$genWeight = 769.7 / 1464447.
t_t$xsec = 118.44
t_t$genWeight = 118.440000 /  3990985.
tbar_t$xsec = 64.47
tbar_t$genWeight = 64.47 /  1999793.
t_tw$xsec = 23.31
t_tw$genWeight = 23.31 / 986096.
tbar_tw$xsec = 23.31
tbar_tw$genWeight = 23.31 / 971797.
t_s$xsec = 7.959
t_s$genWeight = 7.959 / 499999.
tbar_s$xsec = 3.696
tbar_s$genWeight = 3.696 / 250000.
ttp$xsec = 809.1
ttp$genWeight = 809.100000 / 2991597.
hznn$xsec = 0.100352
hznn$genWeight = 0.100352 / 101119.
zj100$xsec = 409.86
zj100$genWeight = 409.86 / 4986410.
zj200$xsec = 580.068
zj200$genWeight = 580.068 / 4936055.
zj600$xsec = 4.5243
zj600$genWeight = 4.5243 / 4463773.
wjInc$xsec = 61623.
wjInc$genWeight = 61623. / 10017431.
wj100$xsec = 2234.91
wj100$genWeight = 2234.91 / 5262249.
wj200$xsec = 580.068
wj200$genWeight = 580.068 / 4936055.
wj400$xsec = 68.4003
wj400$genWeight = 68.4003 / 4640575.
wh$xsec = 0.259581
wh$genWeight = 0.259581 / 100803.
monoH$xsec = 0.12
monoH$genWeight = 0.12 / 10000.
qcd100$name = "QCD100"
qcd250$name = "QCD250"
qcd500$name = "QCD500"
qcd1000$name = "QCD1000"
qcd <- data.frame( met_pt=numeric(), H_mass=numeric(), xsec=numeric(), genWeight=numeric(), name=character(), sample=factor() )
qcd <- rbind(qcd, qcd100)
qcd <- rbind(qcd, qcd250)
qcd <- rbind(qcd, qcd500)
qcd <- rbind(qcd, qcd1000)
qcd$sample <- as.factor(qcd$name)
t_t$name = "T_t"
tbar_t$name = "Tbar_t"
t_tw$name = "T_tW"
tbar_tw$name = "Tbar_tW"
t_s$name = "T_s"
tbar_s$name = "Tbar_s"
singleT <- data.frame( met_pt=numeric(), H_mass=numeric(), xsec=numeric(), genWeight=numeric(), name=character(), sample=factor() )
singleT <- rbind(singleT, t_t)
singleT <- rbind(singleT, tbar_t)
singleT <- rbind(singleT, t_tw)
singleT <- rbind(singleT, tbar_tw)
singleT <- rbind(singleT, t_s)
singleT <- rbind(singleT, tbar_s)
singleT$sample <- as.factor(singleT$name)
zj100$name = "ZJetsHT100"
zj200$name = "ZJetsHT200"
zj600$name = "ZJetsHT600"
zjets <- data.frame( met_pt=numeric(), H_mass=numeric(), xsec=numeric(), genWeight=numeric(), name=character(), sample=factor() )
zjets <- rbind(zjets, zj100)
zjets <- rbind(zjets, zj200)
zjets <- rbind(zjets, zj600)
zjets$sample <- as.factor(zjets$name)
#wjInc$name = "WJetsIncl"
wj100$name = "WJetsHT100"
wj200$name = "WJetsHT200"
wj400$name = "WJetsHT400"
wjets <- data.frame( met_pt=numeric(), H_mass=numeric(), xsec=numeric(), genWeight=numeric(), name=character(), sample=factor() )
wjets <- rbind(wjets, wj100)
wjets <- rbind(wjets, wj200)
wjets <- rbind(wjets, wj400)
wjets$sample <- as.factor(wjets$name)
qcd100$name = "QCD"
qcd250$name = "QCD"
qcd500$name = "QCD"
qcd1000$name = "QCD"
t_t$name = "Single top"
tbar_t$name = "Single top"
t_tw$name = "Single top"
tbar_tw$name = "Single top"
t_s$name = "Single top"
tbar_s$name = "Single top"
ttp$name = "TTPythia"
hznn$name = "ZnnH"
zj100$name = "ZJets"
zj200$name = "ZJets"
zj600$name = "ZJets"
wj100$name = "WJets"
wj200$name = "WJets"
wj400$name = "WJets"
wh$name = "WlnH125"
monoH$name = "monoH"
data <- data.frame( met_pt=numeric(), H_mass=numeric(), xsec=numeric(), genWeight=numeric(), name=character(), sample=factor() )
data <- rbind(data, qcd100)
data <- rbind(data, qcd250)
data <- rbind(data, qcd500)
data <- rbind(data, qcd1000)
data <- rbind(data, t_t)
data <- rbind(data, tbar_t)
data <- rbind(data, t_tw)
data <- rbind(data, tbar_tw)
data <- rbind(data, t_s)
data <- rbind(data, tbar_s)
data <- rbind(data, ttp)
data <- rbind(data, hznn)
data <- rbind(data, zj100)
data <- rbind(data, zj200)
data <- rbind(data, zj600)
##data <- rbind(data, wjInc)
data <- rbind(data, wj100)
data <- rbind(data, wj200)
data <- rbind(data, wj400)
data <- rbind(data, wh)
data <- rbind(data, monoH)
data$sample <- as.factor(data$name)
str(data)
d <- subset(data,hJidx.0.<5 & hJidx.1.<5)
str(d)
hj0pt <- function(entry){ switch(as.integer(entry[["hJidx.0."]])+1, entry[["Jet_pt.0."]],  entry[["Jet_pt.1."]],  entry[["Jet_pt.2."]], entry[["Jet_pt.3."]], entry[["Jet_pt.4."]] )  }
hj1pt <- function(entry){ switch(as.integer(entry[["hJidx.1."]])+1, entry[["Jet_pt.0."]],  entry[["Jet_pt.1."]],  entry[["Jet_pt.2."]], entry[["Jet_pt.3."]], entry[["Jet_pt.4."]] )  }
hj0eta<- function(entry){ switch(as.integer(entry[["hJidx.0."]])+1, entry[["Jet_eta.0."]], entry[["Jet_eta.1."]], entry[["Jet_eta.2."]], entry[["Jet_eta.3."]], entry[["Jet_eta.4."]] ) }
hj1eta<- function(entry){ switch(as.integer(entry[["hJidx.1."]])+1, entry[["Jet_eta.0."]], entry[["Jet_eta.1."]], entry[["Jet_eta.2."]], entry[["Jet_eta.3."]], entry[["Jet_eta.4."]] ) }
select<- function(event){ as.numeric(hj0pt(event))>50 & as.numeric(hj1pt(event))>50 & abs(as.numeric(hj0eta(event)))<2.1 & abs(as.numeric(hj1eta(event)))<2.1 }
d$sel <- apply(d,1,select)
library(ggplot2)
library(scales)
ggplot(data=subset(d,sel=T),aes(x=met_pt,weight=genWeight)) + geom_histogram(breaks=seq(150,300,10),aes(color=sample,fill=sample)) + theme(title=element_text(size=20), axis.title.x = element_text(size=20), axis.text.x=element_text(size=15)) + labs(x=expression(paste(E[T] ^{miss},"(GeV)")),y=expression(paste("# of events weighted to 20 ",fb^{-1})),title="All samples") + theme(legend.position=c(0.85,0.8),  legend.text=element_text(size=15), legend.background = element_rect(fill=alpha('white',0.00001)))
dev.copy(svg,"metAll.svg")
dev.off()
ggplot(data=subset(d,sel=T),aes(x=H_pt,weight=genWeight)) + geom_histogram(breaks=seq(150,300,10),aes(color=sample,fill=sample)) + theme(title=element_text(size=20), axis.title.x = element_text(size=20), axis.text.x=element_text(size=15)) + labs(x=expression(paste(E[T] ^{miss},"(GeV)")),y=expression(paste("# of events weighted to 20 ",fb^{-1})),title="All samples") + theme(legend.position=c(0.85,0.8),  legend.text=element_text(size=15), legend.background = element_rect(fill=alpha('white',0.00001)))
ggplot(data=subset(d,sel=T),aes(x=H_pt,weight=genWeight)) + geom_histogram(breaks=seq(0,800,10),aes(color=sample,fill=sample)) + theme(title=element_text(size=20), axis.title.x = element_text(size=20), axis.text.x=element_text(size=15)) + labs(x=expression(paste(E[T] ^{miss},"(GeV)")),y=expression(paste("# of events weighted to 20 ",fb^{-1})),title="All samples") + theme(legend.position=c(0.85,0.8),  legend.text=element_text(size=15), legend.background = element_rect(fill=alpha('white',0.00001)))
ggplot(data=subset(d,sel=T),aes(x=H_pt,weight=genWeight)) + geom_histogram(breaks=seq(0,500,10),aes(color=sample,fill=sample)) + theme(title=element_text(size=20), axis.title.x = element_text(size=20), axis.text.x=element_text(size=15)) + labs(x=expression(paste(E[T] ^{miss},"(GeV)")),y=expression(paste("# of events weighted to 20 ",fb^{-1})),title="All samples") + theme(legend.position=c(0.85,0.8),  legend.text=element_text(size=15), legend.background = element_rect(fill=alpha('white',0.00001)))
select<- function(event){ as.numeric(hj0pt(event))>50 & as.numeric(hj1pt(event))>50 & abs(as.numeric(hj0eta(event)))<2.1 & abs(as.numeric(hj1eta(event)))<2.1 & ((as.numeric(csv0(event))>0.898 & as.numeric(csv1(event))>0.679) | (as.numeric(csv1(event))>0.898 & as.numeric(csv0(event))>0.679 )) }
d$sel <- apply(d,1,select)
dR12  <- function(entry){ sqrt( as.numeric(hj0eta(event))*as.numeric(hj1eta(event)) + as.numeric(hj0phi(event))*as.numeric(hj1phi(event)) ) }
aj0pt <-function(entry){
switch(as.integer(entry[["hJidx.0."]])+1,
switch(as.integer(entry[["hJidx.1."]])+1,entry[["Jet_pt.1."]],entry[["Jet_pt.2."]],entry[["Jet_pt.1."]],entry[["Jet_pt.1."]],entry[["Jet_pt.1."]] ),
switch(as.integer(entry[["hJidx.1."]])+1,entry[["Jet_pt.2."]],entry[["Jet_pt.0."]],entry[["Jet_pt.0."]],entry[["Jet_pt.0."]],entry[["Jet_pt.0."]] ),
switch(as.integer(entry[["hJidx.1."]])+1,entry[["Jet_pt.1."]],entry[["Jet_pt.0."]],entry[["Jet_pt.0."]],entry[["Jet_pt.0."]],entry[["Jet_pt.0."]] ),
switch(as.integer(entry[["hJidx.1."]])+1,entry[["Jet_pt.1."]],entry[["Jet_pt.0."]],entry[["Jet_pt.0."]],entry[["Jet_pt.0."]],entry[["Jet_pt.0."]] ),
switch(as.integer(entry[["hJidx.1."]])+1,entry[["Jet_pt.1."]],entry[["Jet_pt.0."]],entry[["Jet_pt.0."]],entry[["Jet_pt.0."]],entry[["Jet_pt.0."]] ) )
}
apply(d[1:6,],1,aj0pt)
apply(d[1:6,c("Jet_pt.0.","Jet_pt.1.","Jet_pt.2.","Jet_pt.3.","Jet_pt.4.")],1,aj0pt)
apply(d[1:6,c("Jet_pt.0.","Jet_pt.1.","Jet_pt.2.","Jet_pt.3.","Jet_pt.4.","hJidx.0.","hJidx.1.")],1,aj0pt)
d[1:6,c("Jet_pt.0.","Jet_pt.1.","Jet_pt.2.","Jet_pt.3.","Jet_pt.4.","hJidx.0.","hJidx.1.")]
aj0pt <-function(entry){
switch(as.integer(entry[["hJidx.0."]])+1,
switch(as.integer(entry[["hJidx.1."]])+1,entry[["Jet_pt.1."]],entry[["Jet_pt.2."]],entry[["Jet_pt.1."]],entry[["Jet_pt.1."]],entry[["Jet_pt.1."]] ),
switch(as.integer(entry[["hJidx.1."]])+1,entry[["Jet_pt.2."]],entry[["Jet_pt.0."]],entry[["Jet_pt.0."]],entry[["Jet_pt.0."]],entry[["Jet_pt.0."]] ),
switch(as.integer(entry[["hJidx.1."]])+1,entry[["Jet_pt.1."]],entry[["Jet_pt.0."]],entry[["Jet_pt.0."]],entry[["Jet_pt.0."]],entry[["Jet_pt.0."]] ),
switch(as.integer(entry[["hJidx.1."]])+1,entry[["Jet_pt.1."]],entry[["Jet_pt.0."]],entry[["Jet_pt.0."]],entry[["Jet_pt.0."]],entry[["Jet_pt.0."]] ),
switch(as.integer(entry[["hJidx.1."]])+1,entry[["Jet_pt.1."]],entry[["Jet_pt.0."]],entry[["Jet_pt.0."]],entry[["Jet_pt.0."]],entry[["Jet_pt.0."]] ) )
}
aj1pt <-function(entry){
switch(as.integer(entry[["hJidx.0."]])+1,
switch(as.integer(entry[["hJidx.1."]])+1,entry[["Jet_pt.2."]],entry[["Jet_pt.3."]],entry[["Jet_pt.3."]],entry[["Jet_pt.2."]],entry[["Jet_pt.2."]] ),
switch(as.integer(entry[["hJidx.1."]])+1,entry[["Jet_pt.3."]],entry[["Jet_pt.2."]],entry[["Jet_pt.3."]],entry[["Jet_pt.2."]],entry[["Jet_pt.2."]] ),
switch(as.integer(entry[["hJidx.1."]])+1,entry[["Jet_pt.3."]],entry[["Jet_pt.4."]],entry[["Jet_pt.1."]],entry[["Jet_pt.1."]],entry[["Jet_pt.1."]] ),
switch(as.integer(entry[["hJidx.1."]])+1,entry[["Jet_pt.2."]],entry[["Jet_pt.2."]],entry[["Jet_pt.1."]],entry[["Jet_pt.1."]],entry[["Jet_pt.1."]] ),
switch(as.integer(entry[["hJidx.1."]])+1,entry[["Jet_pt.2."]],entry[["Jet_pt.2."]],entry[["Jet_pt.1."]],entry[["Jet_pt.1."]],entry[["Jet_pt.1."]] ) )
}
aj1eta <-function(entry){
switch(as.integer(entry[["hJidx.0."]])+1,
switch(as.integer(entry[["hJidx.1."]])+1,entry[["Jet_eta.2."]],entry[["Jet_eta.3."]],entry[["Jet_eta.3."]],entry[["Jet_eta.2."]],entry[["Jet_eta.2."]] ),
switch(as.integer(entry[["hJidx.1."]])+1,entry[["Jet_eta.3."]],entry[["Jet_eta.2."]],entry[["Jet_eta.3."]],entry[["Jet_eta.2."]],entry[["Jet_eta.2."]] ),
switch(as.integer(entry[["hJidx.1."]])+1,entry[["Jet_eta.3."]],entry[["Jet_eta.4."]],entry[["Jet_eta.1."]],entry[["Jet_eta.1."]],entry[["Jet_eta.1."]] ),
switch(as.integer(entry[["hJidx.1."]])+1,entry[["Jet_eta.2."]],entry[["Jet_eta.2."]],entry[["Jet_eta.1."]],entry[["Jet_eta.1."]],entry[["Jet_eta.1."]] ),
switch(as.integer(entry[["hJidx.1."]])+1,entry[["Jet_eta.2."]],entry[["Jet_eta.2."]],entry[["Jet_eta.1."]],entry[["Jet_eta.1."]],entry[["Jet_eta.1."]] ) )
}
select<- function(event){ as.integer(event[["VType"]])==4 & as.numeric(hj0pt(event))>50 & as.numeric(hj1pt(event))>50 & abs(as.numeric(hj0eta(event)))<2.1 & abs(as.numeric(hj1eta(event)))<2.1 & ((as.numeric(csv0(event))>0.898 & as.numeric(csv1(event))>0.679) | (as.numeric(csv1(event))>0.898 & as.numeric(csv0(event))>0.679 )) & dR12(event)<1.3 & (as.numeric(nJet<4 | aj1pt(event)<30 | aj1pt(event))>2.4) }
d$sel <- apply(d,1,select)
qplot(data$VType)
qplot(data$Vtype)
select<- function(event){ as.integer(event[["Vtype"]])==4 & as.numeric(hj0pt(event))>50 & as.numeric(hj1pt(event))>50 & abs(as.numeric(hj0eta(event)))<2.1 & abs(as.numeric(hj1eta(event)))<2.1 & ((as.numeric(csv0(event))>0.898 & as.numeric(csv1(event))>0.679) | (as.numeric(csv1(event))>0.898 & as.numeric(csv0(event))>0.679 )) & dR12(event)<1.3 & (as.numeric(nJet<4 | aj1pt(event)<30 | aj1pt(event))>2.4) }
d$sel <- apply(d,1,select)
apply(d[1:6,],1,select)
apply(d[1:6,],1,csv0)
csv0  <- function(entry){ switch(as.integer(entry[["hJidx.0."]])+1, entry[["Jet_btagCSV.0."]], entry[["Jet_btagCSV.1."]], entry[["Jet_btagCSV.2."]], entry[["Jet_btagCSV.3."]], entry[["Jet_btagCSV.4."]] ) }
csv1  <- function(entry){ switch(as.integer(entry[["hJidx.1."]])+1, entry[["Jet_btagCSV.0."]], entry[["Jet_btagCSV.1."]], entry[["Jet_btagCSV.2."]], entry[["Jet_btagCSV.3."]], entry[["Jet_btagCSV.4."]] ) }
apply(d[1:6,],1,csv0)
d$sel <- apply(d,1,select)
hj0eta
apply(d[1:6,],1,select)
apply(d[1:6,],1,hj0eta)
apply(d[1:6,],1,select)
dR12  <- function(entry){ sqrt( as.numeric(hj0eta(entry))*as.numeric(hj1eta(entry)) + as.numeric(hj0phi(entry))*as.numeric(hj1phi(entry)) ) }
apply(d[1:6,],1,select)
hj0phi<- function(entry){ switch(as.integer(entry[["hJidx.0."]])+1, entry[["Jet_phi.0."]], entry[["Jet_phi.1."]], entry[["Jet_phi.2."]], entry[["Jet_phi.3."]], entry[["Jet_phi.4."]] ) }
hj1phi<- function(entry){ switch(as.integer(entry[["hJidx.1."]])+1, entry[["Jet_phi.0."]], entry[["Jet_phi.1."]], entry[["Jet_phi.2."]], entry[["Jet_phi.3."]], entry[["Jet_phi.4."]] ) }
apply(d[1:6,],1,select)
apply(d[1:6,],1,hj0eta)
apply(d[1:6,],1,hj1eta)
apply(d[1:6,],1,dR12)
dR12  <- function(entry){ sqrt( (as.numeric(hj0eta(entry))-as.numeric(hj1eta(entry)))*(as.numeric(hj0eta(entry))-as.numeric(hj1eta(entry))) + (as.numeric(hj0phi(entry))-as.numeric(hj1phi(entry)))*(as.numeric(hj0phi(entry))-as.numeric(hj1phi(entry))) ) }
apply(d[1:6,],1,dR12)
d$sel <- apply(d,1,select)
qplot(data$nJet)
select<- function(event){ as.integer(event[["Vtype"]])==4 & as.numeric(hj0pt(event))>50 & as.numeric(hj1pt(event))>50 & abs(as.numeric(hj0eta(event)))<2.1 & abs(as.numeric(hj1eta(event)))<2.1 & ((as.numeric(csv0(event))>0.898 & as.numeric(csv1(event))>0.679) | (as.numeric(csv1(event))>0.898 & as.numeric(csv0(event))>0.679 )) & dR12(event)<1.3 & (as.numeric(event[["nJet"]])<4 | as.numeric(j1pt(event))<30 | as.numeric(aj1pt(event)))>2.4) }
select<- function(event){ as.integer(event[["Vtype"]])==4 & as.numeric(hj0pt(event))>50 & as.numeric(hj1pt(event))>50 & abs(as.numeric(hj0eta(event)))<2.1 & abs(as.numeric(hj1eta(event)))<2.1 & ((as.numeric(csv0(event))>0.898 & as.numeric(csv1(event))>0.679) | (as.numeric(csv1(event))>0.898 & as.numeric(csv0(event))>0.679 )) & dR12(event)<1.3 & (as.numeric(event[["nJet"]])<4 | as.numeric(j1pt(event))<30 | as.numeric(aj1pt(event)))>2.4)) }
select<- function(event){ as.integer(event[["Vtype"]])==4 & as.numeric(hj0pt(event))>50 & as.numeric(hj1pt(event))>50 & abs(as.numeric(hj0eta(event)))<2.1 & abs(as.numeric(hj1eta(event)))<2.1 & ((as.numeric(csv0(event))>0.898 & as.numeric(csv1(event))>0.679) | (as.numeric(csv1(event))>0.898 & as.numeric(csv0(event))>0.679 )) & dR12(event)<1.3 & (as.numeric(event[["nJet"]])<4 | as.numeric(j1pt(event))<30 | as.numeric(aj1pt(event))>2.4) }
d$sel <- apply(d,1,select)
apply(d[1:6,],1,select)
;5~select<- function(event){ as.integer(event[["Vtype"]])==4 & as.numeric(hj0pt(event))>50 & as.numeric(hj1pt(event))>50 & abs(as.numeric(hj0eta(event)))<2.1 & abs(as.numeric(hj1eta(event)))<2.1 & ((as.numeric(csv0(event))>0.898 & as.numeric(csv1(event))>0.679) | (as.numeric(csv1(event))>0.898 & as.numeric(csv0(event))>0.679 )) & dR12(event)<1.3 & (as.numeric(event[["nJet"]])<4 | as.numeric(aj1pt(event))<30 | as.numeric(aj1pt(event))>2.4) }
select<- function(event){ as.integer(event[["Vtype"]])==4 & as.numeric(hj0pt(event))>50 & as.numeric(hj1pt(event))>50 & abs(as.numeric(hj0eta(event)))<2.1 & abs(as.numeric(hj1eta(event)))<2.1 & ((as.numeric(csv0(event))>0.898 & as.numeric(csv1(event))>0.679) | (as.numeric(csv1(event))>0.898 & as.numeric(csv0(event))>0.679 )) & dR12(event)<1.3 & (as.numeric(event[["nJet"]])<4 | as.numeric(aj1pt(event))<30 | as.numeric(aj1pt(event))>2.4) }
apply(d[1:6,],1,select)
d$sel <- apply(d,1,select)
ggplot(data=subset(d,sel=T),aes(x=met_pt,weight=genWeight)) + geom_histogram(breaks=seq(150,300,10),aes(color=sample,fill=sample)) + theme(title=element_text(size=20), axis.title.x = element_text(size=20), axis.text.x=element_text(size=15)) + labs(x=expression(paste(E[T] ^{miss},"(GeV)")),y=expression(paste("# of events weighted to 20 ",fb^{-1})),title="All samples") + theme(legend.position=c(0.85,0.8),  legend.text=element_text(size=15), legend.background = element_rect(fill=alpha('white',0.00001)))
select<- function(event){ as.integer(event[["Vtype"]])==4 & ((as.numeric(hj0pt(event))>80 & as.numeric(hj1pt(event))>30) | (as.numeric(hj0pt(event))>30 & as.numeric(hj1pt(event))>80)) & abs(as.numeric(hj0eta(event)))<2.1 & abs(as.numeric(hj1eta(event)))<2.1 & ((as.numeric(csv0(event))>0.898 & as.numeric(csv1(event))>0.679) | (as.numeric(csv1(event))>0.898 & as.numeric(csv0(event))>0.679 )) & dR12(event)<1.3 & (as.numeric(event[["nJet"]])<4 | as.numeric(aj1pt(event))<30 | as.numeric(aj1pt(event))>2.4) }
apply(d[1:6,],1,select)
d$sel <- apply(d,1,select)
select<- function(event){ as.integer(event[["Vtype"]])==4 & ((as.numeric(hj0pt(event))>80 & as.numeric(hj1pt(event))>30) | (as.numeric(hj0pt(event))>30 & as.numeric(hj1pt(event))>80)) & abs(as.numeric(hj0eta(event)))<2.1 & abs(as.numeric(hj1eta(event)))<2.1 & ((as.numeric(csv0(event))>0.898 & as.numeric(csv1(event))>0.679) | (as.numeric(csv1(event))>0.898 & as.numeric(csv0(event))>0.679 )) & dR12(event)<1.3 & (as.numeric(event[["nJet"]])<4 | as.numeric(aj1pt(event))<30 | as.numeric(aj1pt(event))>2.4) }
dev.copy(svg,"metAll.svg")
dev.off()
ggplot(data=subset(d,sel=T),aes(x=met_pt,weight=genWeight)) + geom_histogram(breaks=seq(150,300,10),aes(color=sample,fill=sample)) + theme(title=element_text(size=20), axis.title.x = element_text(size=20), axis.text.x=element_text(size=15)) + labs(x=expression(paste(E[T] ^{miss},"(GeV)")),y=expression(paste("# of events weighted to 20 ",fb^{-1})),title="All samples") + theme(legend.position=c(0.85,0.8),  legend.text=element_text(size=15), legend.background = element_rect(fill=alpha('white',0.00001)))
dev.copy(svg,"metAll.svg")
dev.off()
ggplot(data=subset(d,sel=T),aes(x=H_pt,weight=genWeight)) + geom_histogram(breaks=seq(0,500,10),aes(color=sample,fill=sample)) + theme(title=element_text(size=20), axis.title.x = element_text(size=20), axis.text.x=element_text(size=15)) + labs(x=expression(paste(E[T] ^{miss},"(GeV)")),y=expression(paste("# of events weighted to 20 ",fb^{-1})),title="All samples") + theme(legend.position=c(0.85,0.8),  legend.text=element_text(size=15), legend.background = element_rect(fill=alpha('white',0.00001)))
ggplot(data=subset(d,sel=T),aes(x=H_pt,weight=genWeight)) + geom_histogram(breaks=seq(0,500,10),aes(color=sample,fill=sample)) + theme(title=element_text(size=20), axis.title.x = element_text(size=20), axis.text.x=element_text(size=15)) + labs(x=expression(paste(H[p[T]],"(GeV)")),y=expression(paste("# of events weighted to 20 ",fb^{-1})),title="All samples") + theme(legend.position=c(0.85,0.8),  legend.text=element_text(size=15), legend.background = element_rect(fill=alpha('white',0.00001)))
dev.copy(svg,"hptAll.svg")
dev.off()
ggplot(data=hznn,aes(x=H_mass)) + geom_histogram(breaks=seq(60,160,1),color="steelblue",fill="steelblue") + theme(title=element_text(size=20), axis.title.x = element_text(size=20), axis.text.x=element_text(size=15)) + labs(x=expression(paste(m[Higgs],"(GeV)")),y="# of events",title=expression(paste("Z(",nu,nu,")H(bb) sample")))
ggplot(data=hznn,aes(x=H_mass)) + geom_histogram(breaks=seq(60,160,1),color="steelblue",fill="steelblue") + theme(title=element_text(size=20), axis.title.x = element_text(size=20), axis.text.x=element_text(size=15)) + labs(x=expression(paste(m[Higgs],"(GeV)")),y="# of unweighted events",title=expression(paste("Z(",nu,nu,")H(bb) sample")))
dev.copy(svg,"hm.svg")
dev.off()
ggplot(data=subset(d,sel=T),aes(x=H_pt,weight=genWeight)) + geom_histogram(breaks=seq(60,160,10),aes(color=sample,fill=sample)) + theme(title=element_text(size=20), axis.title.x = element_text(size=20), axis.text.x=element_text(size=15)) + labs(x=expression(paste(H[p[T]],"(GeV)")),y=expression(paste("# of events weighted to 20 ",fb^{-1})),title="All samples") + theme(legend.position=c(0.85,0.8),  legend.text=element_text(size=15), legend.background = element_rect(fill=alpha('white',0.00001)))
ggplot(data=subset(d,sel=T),aes(x=H_mass,weight=genWeight)) + geom_histogram(breaks=seq(60,160,10),aes(color=sample,fill=sample)) + theme(title=element_text(size=20), axis.title.x = element_text(size=20), axis.text.x=element_text(size=15)) + labs(x=expression(paste(H[p[T]],"(GeV)")),y=expression(paste("# of events weighted to 20 ",fb^{-1})),title="All samples") + theme(legend.position=c(0.85,0.8),  legend.text=element_text(size=15), legend.background = element_rect(fill=alpha('white',0.00001)))
ggplot(data=subset(d,sel=T & met_pt>200),aes(x=H_mass,weight=genWeight)) + geom_histogram(breaks=seq(60,160,10),aes(color=sample,fill=sample)) + theme(title=element_text(size=20), axis.title.x = element_text(size=20), axis.text.x=element_text(size=15)) + labs(x=expression(paste(H[p[T]],"(GeV)")),y=expression(paste("# of events weighted to 20 ",fb^{-1})),title="All samples") + theme(legend.position=c(0.85,0.8),  legend.text=element_text(size=15), legend.background = element_rect(fill=alpha('white',0.00001)))
names(d)
head( subset(d,sel=T & met_pt>200) )
head( d$met_pt )
head( subset(d,met_pt>200) )
head( subset(d,met_pt>200 && sel=T) )
head( subset(d,met_pt>200 & sel=T) )
head( subset(d,met_pt>200 & sel==T) )
ggplot(data=subset(d,sel==T & met_pt>200),aes(x=H_mass,weight=genWeight)) + geom_histogram(breaks=seq(60,160,10),aes(color=sample,fill=sample)) + theme(title=element_text(size=20), axis.title.x = element_text(size=20), axis.text.x=element_text(size=15)) + labs(x=expression(paste(H[p[T]],"(GeV)")),y=expression(paste("# of events weighted to 20 ",fb^{-1})),title="All samples") + theme(legend.position=c(0.85,0.8),  legend.text=element_text(size=15), legend.background = element_rect(fill=alpha('white',0.00001)))
ggplot(data=subset(d,sel==T),aes(x=H_mass,weight=genWeight)) + geom_histogram(breaks=seq(60,160,10),aes(color=sample,fill=sample)) + theme(title=element_text(size=20), axis.title.x = element_text(size=20), axis.text.x=element_text(size=15)) + labs(x=expression(paste(H[p[T]],"(GeV)")),y=expression(paste("# of events weighted to 20 ",fb^{-1})),title="All samples") + theme(legend.position=c(0.85,0.8),  legend.text=element_text(size=15), legend.background = element_rect(fill=alpha('white',0.00001)))
ggplot(data=subset(d,sel==T & sample=="monoH" ),aes(x=H_mass)) + geom_histogram(breaks=seq(60,160,1),color="steelblue",fill="steelblue") + theme(title=element_text(size=20), axis.title.x = element_text(size=20), axis.text.x=element_text(size=15)) + labs(x=expression(paste(m[Higgs],"(GeV)")),y="# of unweighted events",title=expression(paste("Z(",nu,nu,")H(bb) sample")))
ggplot(data=subset(d,sample=="monoH" ),aes(x=H_mass)) + geom_histogram(breaks=seq(60,160,1),color="steelblue",fill="steelblue") + theme(title=element_text(size=20), axis.title.x = element_text(size=20), axis.text.x=element_text(size=15)) + labs(x=expression(paste(m[Higgs],"(GeV)")),y="# of unweighted events",title=expression(paste("Z(",nu,nu,")H(bb) sample")))
library(ggplot2)
library(scales)
ggplot(data=subset(d,sel==T),aes(x=met_pt,weight=genWeight)) + geom_histogram(breaks=seq(150,450,50),aes(color=sample,fill=sample)) + theme(title=element_text(size=20), axis.title.x = element_text(size=20), axis.text.x=element_text(size=15)) + labs(x=expression(paste(E[T] ^{miss},"(GeV)")),y=expression(paste("# of events weighted to 20 ",fb^{-1})),title="All samples") + theme(legend.position=c(0.85,0.8),  legend.text=element_text(size=15), legend.background = element_rect(fill=alpha('white',0.00001)))
ggplot(data=subset(d,sel==T),aes(x=met_pt,weight=genWeight)) + geom_histogram(breaks=seq(0,500,10),aes(color=sample,fill=sample)) + theme(title=element_text(size=20), axis.title.x = element_text(size=20), axis.text.x=element_text(size=15)) + labs(x=expression(paste(E[T] ^{miss},"(GeV)")),y=expression(paste("# of events weighted to 20 ",fb^{-1})),title="All samples") + theme(legend.position=c(0.85,0.8),  legend.text=element_text(size=15), legend.background = element_rect(fill=alpha('white',0.00001)))
dev.copy(svg,"metAllSel.svg")
dev.off()
ggplot(data=subset(d,sel==T),aes(x=H_mass,weight=genWeight)) + geom_histogram(breaks=seq(0,300,30),aes(color=sample,fill=sample)) + theme(title=element_text(size=20), axis.title.x = element_text(size=20), axis.text.x=element_text(size=15)) + labs(x=expression(paste(p[T]^{Higgs},"(GeV)")),y=expression(paste("# of events weighted to 20 ",fb^{-1})),title="All samples") + theme(legend.position=c(0.85,0.8),  legend.text=element_text(size=15), legend.background = element_rect(fill=alpha('white',0.00001)))
dev.copy(svg,"hptAllSel.svg")
dev.off()
ggplot(data=subset(d,sel==T),aes(x=met_pt,weight=genWeight)) + geom_histogram(breaks=seq(0,300,10),aes(color=sample,fill=sample)) + theme(title=element_text(size=20), axis.title.x = element_text(size=20), axis.text.x=element_text(size=15)) + labs(x=expression(paste(E[T] ^{miss},"(GeV)")),y=expression(paste("# of events weighted to 20 ",fb^{-1})),title="All samples") + theme(legend.position=c(0.85,0.8),  legend.text=element_text(size=15), legend.background = element_rect(fill=alpha('white',0.00001)))
ggplot(data=subset(d,sel==T),aes(x=met_pt,weight=genWeight)) + geom_histogram(breaks=seq(0,500,10),aes(color=sample,fill=sample)) + theme(title=element_text(size=20), axis.title.x = element_text(size=20), axis.text.x=element_text(size=15)) + labs(x=expression(paste(E[T] ^{miss},"(GeV)")),y=expression(paste("# of events weighted to 20 ",fb^{-1})),title="All samples") + theme(legend.position=c(0.85,0.8),  legend.text=element_text(size=15), legend.background = element_rect(fill=alpha('white',0.00001)))
dev.copy(svg,"metAllSelWide.svg")
def.off()
dev.off()
ggplot(data=subset(d,sel==T),aes(x=H_pt,weight=genWeight)) + geom_histogram(breaks=seq(0,500,10),aes(color=sample,fill=sample)) + theme(title=element_text(size=20), axis.title.x = element_text(size=20), axis.text.x=element_text(size=15)) + labs(x=expression(paste(p[T] ^{Higgs},"(GeV)")),y=expression(paste("# of events weighted to 20 ",fb^{-1})),title="All samples") + theme(legend.position=c(0.85,0.8),  legend.text=element_text(size=15), legend.background = element_rect(fill=alpha('white',0.00001)))
ggplot(data=subset(d,sel==T),aes(x=H_pt,weight=genWeight)) + geom_histogram(breaks=seq(0,700,35),aes(color=sample,fill=sample)) + theme(title=element_text(size=20), axis.title.x = element_text(size=20), axis.text.x=element_text(size=15)) + labs(x=expression(paste(p[T] ^{Higgs},"(GeV)")),y=expression(paste("# of events weighted to 20 ",fb^{-1})),title="All samples") + theme(legend.position=c(0.85,0.8),  legend.text=element_text(size=15), legend.background = element_rect(fill=alpha('white',0.00001)))
ggplot(data=subset(d,sel==T),aes(x=H_pt,weight=genWeight)) + geom_histogram(breaks=seq(0,800,40),aes(color=sample,fill=sample)) + theme(title=element_text(size=20), axis.title.x = element_text(size=20), axis.text.x=element_text(size=15)) + labs(x=expression(paste(p[T] ^{Higgs},"(GeV)")),y=expression(paste("# of events weighted to 20 ",fb^{-1})),title="All samples") + theme(legend.position=c(0.85,0.8),  legend.text=element_text(size=15), legend.background = element_rect(fill=alpha('white',0.00001)))
dev.copy(svg,"hptAllSelWide.svg")
dev.off()
ggplot(data=subset(d,sel==T),aes(x=met_pt,weight=genWeight)) + geom_histogram(breaks=seq(0,800,40),aes(color=sample,fill=sample)) + theme(title=element_text(size=20), axis.title.x = element_text(size=20), axis.text.x=element_text(size=15)) + labs(x=expression(paste(E[T] ^{miss},"(GeV)")),y=expression(paste("# of events weighted to 20 ",fb^{-1})),title="All samples") + theme(legend.position=c(0.85,0.8),  legend.text=element_text(size=15), legend.background = element_rect(fill=alpha('white',0.00001)))
dev.copy(svg,"metAllSelWide.svg")
dev.off()
ggplot(data=subset(d,sel==T),aes(x=H_mass,weight=genWeight)) + geom_histogram(breaks=seq(60,160,1),aes(color=sample,fill=sample)) + theme(title=element_text(size=20), axis.title.x = element_text(size=20), axis.text.x=element_text(size=15)) + labs(x=expression(paste(p[T]^{Higgs},"(GeV)")),y=expression(paste("# of events weighted to 20 ",fb^{-1})),title="All samples") + theme(legend.position=c(0.85,0.8),  legend.text=element_text(size=15), legend.background = element_rect(fill=alpha('white',0.00001)))
ggplot(data=subset(d,sel==T),aes(x=H_mass,weight=genWeight)) + geom_histogram(breaks=seq(60,160,10),aes(color=sample,fill=sample)) + theme(title=element_text(size=20), axis.title.x = element_text(size=20), axis.text.x=element_text(size=15)) + labs(x=expression(paste(p[T]^{Higgs},"(GeV)")),y=expression(paste("# of events weighted to 20 ",fb^{-1})),title="All samples") + theme(legend.position=c(0.85,0.8),  legend.text=element_text(size=15), legend.background = element_rect(fill=alpha('white',0.00001)))
ggplot(data=subset(d,sel==T),aes(x=H_mass,weight=genWeight)) + geom_histogram(breaks=seq(0,220,10),aes(color=sample,fill=sample)) + theme(title=element_text(size=20), axis.title.x = element_text(size=20), axis.text.x=element_text(size=15)) + labs(x=expression(paste(p[T]^{Higgs},"(GeV)")),y=expression(paste("# of events weighted to 20 ",fb^{-1})),title="All samples") + theme(legend.position=c(0.85,0.8),  legend.text=element_text(size=15), legend.background = element_rect(fill=alpha('white',0.00001)))
ggplot(data=subset(d,sel==T),aes(x=H_mass,weight=genWeight)) + geom_histogram(breaks=seq(0,220,10),aes(color=sample,fill=sample)) + theme(title=element_text(size=20), axis.title.x = element_text(size=20), axis.text.x=element_text(size=15)) + labs(x=expression(paste(m[Higgs],"(GeV)")),y=expression(paste("# of events weighted to 20 ",fb^{-1})),title="All samples") + theme(legend.position=c(0.85,0.8),  legend.text=element_text(size=15), legend.background = element_rect(fill=alpha('white',0.00001)))
dev.copy(svg,"hmSelWide.svg")
dev.off()
ggplot(data=subset(d,sample=="monoH" ),aes(x=H_mass)) + geom_histogram(breaks=seq(60,160,1),color="steelblue",fill="steelblue") + theme(title=element_text(size=20), axis.title.x = element_text(size=20), axis.text.x=element_text(size=15)) + labs(x=expression(paste(m[Higgs],"(GeV)")),y="# of unweighted events",title=expression(paste("Z(",nu,nu,")H(bb) sample")))
ggplot(data=subset(d,sel==T & sample=="ZnnH" ),aes(x=H_mass)) + geom_histogram(breaks=seq(60,160,1),color="steelblue",fill="steelblue") + theme(title=element_text(size=20), axis.title.x = element_text(size=20), axis.text.x=element_text(size=15)) + labs(x=expression(paste(m[Higgs],"(GeV)")),y="# of unweighted events",title=expression(paste("Z(",nu,nu,")H(bb) sample")))
ggplot(data=subset(d,sel==T & sample=="ZnnH" ),aes(x=H_mass)) + geom_histogram(breaks=seq(0,200,10),color="steelblue",fill="steelblue") + theme(title=element_text(size=20), axis.title.x = element_text(size=20), axis.text.x=element_text(size=15)) + labs(x=expression(paste(m[Higgs],"(GeV)")),y="# of unweighted events",title=expression(paste("Z(",nu,nu,")H(bb) sample")))
dev.copy(svg,"hmSel.svg")
dev.off()
ggplot(data=subset(d,sel==T),aes(x=met_pt,weight=genWeight)) + geom_histogram(breaks=seq(0,800,40),aes(color=sample,fill=sample)) + theme(title=element_text(size=20), axis.title.x = element_text(size=20), axis.text.x=element_text(size=15)) + labs(x=expression(paste(E[T] ^{miss},"(GeV)")),y=expression(paste("# of events weighted to 20 ",fb^{-1})),title="All samples") + theme(legend.position=c(0.85,0.8),  legend.text=element_text(size=15), legend.background = element_rect(fill=alpha('white',0.00001)))
library(ggplot2)
library(scales)
head(d[genWeight, sample="monoH"])
head(d[genWeight, sample=="monoH"])
head(d[, sample=="monoH"])
head(subset(d, sample=="monoH"])
names(d)
sample
head(d$sample)
head(d$sample=="monoHiggs")
head(d[,d$sample=="monoHiggs"])
head(d[,d$sample=="monoH"])
levels(d$sample)
any(d$sample=="monoH")
sum(d$sample=="monoH")
head(d[d$sample=="monoH",])
mh <- d[d$sample=="monoH",]
d[d$sample=="monoH",genWeight] <- 0.000012*100000
d$genWeight[d$sample=="monoH",] <- 0.000012*100000
head( d$genWeight[d$sample=="monoH",] )
ggplot(data=subset(mh,sel==T),aes(x=met_pt,weight=genWeight)) + geom_histogram(breaks=seq(0,800,40),aes(color=sample,fill=sample,y = ..density..,)) + theme(title=element_text(size=20), axis.title.x = element_text(size=20), axis.text.x=element_text(size=15)) + labs(x=expression(paste(E[T] ^{miss},"(GeV)")),y=expression(paste("# of events weighted to 20 ",fb^{-1})),title="All samples") + theme(legend.position=c(0.85,0.8),  legend.text=element_text(size=15), legend.background = element_rect(fill=alpha('white',0.00001)))
ggplot(data=subset(mh,sel==T),aes(x=met_pt)) + geom_histogram(breaks=seq(0,800,40),aes(color=sample,fill=sample,y = ..density..,)) + theme(title=element_text(size=20), axis.title.x = element_text(size=20), axis.text.x=element_text(size=15)) + labs(x=expression(paste(E[T] ^{miss},"(GeV)")),y=expression(paste("# of events weighted to 20 ",fb^{-1})),title="All samples") + theme(legend.position=c(0.85,0.8),  legend.text=element_text(size=15), legend.background = element_rect(fill=alpha('white',0.00001)))
ggplot(data=subset(mh,sel==T),aes(x=met_pt)) + geom_histogram(breaks=seq(0,800,40),aes(color=sample,fill=sample)) + theme(title=element_text(size=20), axis.title.x = element_text(size=20), axis.text.x=element_text(size=15)) + labs(x=expression(paste(E[T] ^{miss},"(GeV)")),y=expression(paste("# of events weighted to 20 ",fb^{-1})),title="All samples") + theme(legend.position=c(0.85,0.8),  legend.text=element_text(size=15), legend.background = element_rect(fill=alpha('white',0.00001)))
ggplot(data=subset(mh,sel==T),aes(x=met_pt)) + geom_histogram(breaks=seq(0,800,40),aes(color=sample,fill=sample,y=..density..)) + theme(title=element_text(size=20), axis.title.x = element_text(size=20), axis.text.x=element_text(size=15)) + labs(x=expression(paste(E[T] ^{miss},"(GeV)")),y=expression(paste("# of events weighted to 20 ",fb^{-1})),title="All samples") + theme(legend.position=c(0.85,0.8),  legend.text=element_text(size=15), legend.background = element_rect(fill=alpha('white',0.00001)))
ggplot(histogram,aes(x=met_pt)) + geom_histogram(data=subset(d,sel==T),breaks=seq(0,800,40),aes(color=sample,fill=sample,y=..density..)) + theme(title=element_text(size=20), axis.title.x = element_text(size=20), axis.text.x=element_text(size=15)) + labs(x=expression(paste(E[T] ^{miss},"(GeV)")),y=expression(paste("# of events weighted to 20 ",fb^{-1})),title="All samples") + theme(legend.position=c(0.85,0.8),  legend.text=element_text(size=15), legend.background = element_rect(fill=alpha('white',0.00001))) + geom_histogram(data=subset(mh,sel==T),color=black,aes(y=..density..))
ggplot(data=subset(d,sel==T),aes(x=met_pt)) + geom_histogram(data=subset(d,sel==T),breaks=seq(0,800,40),aes(color=sample,fill=sample,y=..density..)) + theme(title=element_text(size=20), axis.title.x = element_text(size=20), axis.text.x=element_text(size=15)) + labs(x=expression(paste(E[T] ^{miss},"(GeV)")),y=expression(paste("# of events weighted to 20 ",fb^{-1})),title="All samples") + theme(legend.position=c(0.85,0.8),  legend.text=element_text(size=15), legend.background = element_rect(fill=alpha('white',0.00001))) + geom_histogram(data=subset(mh,sel==T),color=black,aes(y=..density..))
ggplot(data=subset(d,sel==T),aes(x=met_pt)) + geom_histogram(data=subset(d,sel==T),breaks=seq(0,800,40),aes(color=sample,fill=sample,y=..density..)) + theme(title=element_text(size=20), axis.title.x = element_text(size=20), axis.text.x=element_text(size=15)) + labs(x=expression(paste(E[T] ^{miss},"(GeV)")),y=expression(paste("# of events weighted to 20 ",fb^{-1})),title="All samples") + theme(legend.position=c(0.85,0.8),  legend.text=element_text(size=15), legend.background = element_rect(fill=alpha('white',0.00001))) + geom_histogram(data=subset(mh,sel==T),aes(color=black,y=..density..))
ggplot(data=subset(d,sel==T),aes(x=met_pt)) + geom_histogram(data=subset(d,sel==T),breaks=seq(0,800,40),aes(color=sample,fill=sample,y=..density..)) + theme(title=element_text(size=20), axis.title.x = element_text(size=20), axis.text.x=element_text(size=15)) + labs(x=expression(paste(E[T] ^{miss},"(GeV)")),y=expression(paste("# of events weighted to 20 ",fb^{-1})),title="All samples") + theme(legend.position=c(0.85,0.8),  legend.text=element_text(size=15), legend.background = element_rect(fill=alpha('white',0.00001))) + geom_histogram(data=subset(mh,sel==T),aes(y=..density..))
ggplot(data=subset(d,sel==T),aes(x=met_pt)) + geom_histogram(data=subset(d,sel==T),breaks=seq(0,800,40),aes(color=sample,fill=sample,y=..density..)) + geom_histogram(data=subset(mh,sel==T),aes(y=..density..))   + theme(title=element_text(size=20), axis.title.x = element_text(size=20), axis.text.x=element_text(size=15)) + labs(x=expression(paste(E[T] ^{miss},"(GeV)")),y=expression(paste("# of events weighted to 20 ",fb^{-1})),title="All samples") + theme(legend.position=c(0.85,0.8),  legend.text=element_text(size=15), legend.background = element_rect(fill=alpha('white',0.00001)))
ggplot(data=subset(d,sel==T),aes(x=met_pt)) + geom_histogram(data=subset(d,sel==T),breaks=seq(0,800,40),aes(color=sample,fill=sample,y=..density..)) + geom_histogram(data=subset(mh,sel==T),breaks=seq(0,800,40),aes(y=..density..))   + theme(title=element_text(size=20), axis.title.x = element_text(size=20), axis.text.x=element_text(size=15)) + labs(x=expression(paste(E[T] ^{miss},"(GeV)")),y=expression(paste("# of events weighted to 20 ",fb^{-1})),title="All samples") + theme(legend.position=c(0.85,0.8),  legend.text=element_text(size=15), legend.background = element_rect(fill=alpha('white',0.00001)))
ggplot(data=subset(d,sel==T),aes(x=met_pt)) + geom_histogram(data=subset(d,sel==T),breaks=seq(0,800,40),aes(color=sample,fill=sample,y=..density..),alpha = 0.2) + geom_histogram(data=subset(mh,sel==T),breaks=seq(0,800,40),aes(y=..density..),alpha = 0.2)   + theme(title=element_text(size=20), axis.title.x = element_text(size=20), axis.text.x=element_text(size=15)) + labs(x=expression(paste(E[T] ^{miss},"(GeV)")),y=expression(paste("# of events weighted to 20 ",fb^{-1})),title="All samples") + theme(legend.position=c(0.85,0.8),  legend.text=element_text(size=15), legend.background = element_rect(fill=alpha('white',0.00001)))
ggplot(data=subset(d,sel==T),aes(x=met_pt)) + geom_histogram(data=subset(d,sel==T),breaks=seq(0,800,40),aes(fill=sample,y=..density..),alpha = 0.2) + geom_histogram(data=subset(mh,sel==T),breaks=seq(0,800,40),aes(y=..density..),alpha = 0.2)   + theme(title=element_text(size=20), axis.title.x = element_text(size=20), axis.text.x=element_text(size=15)) + labs(x=expression(paste(E[T] ^{miss},"(GeV)")),y=expression(paste("# of events weighted to 20 ",fb^{-1})),title="All samples") + theme(legend.position=c(0.85,0.8),  legend.text=element_text(size=15), legend.background = element_rect(fill=alpha('white',0.00001)))
ggplot(data=subset(d,sel==T),aes(x=met_pt)) + geom_histogram(data=subset(d,sel==T),breaks=seq(0,800,40),aes(fill=sample,y=..density..),alpha = 0.4) + geom_histogram(data=subset(mh,sel==T),breaks=seq(0,800,40),aes(y=..density..),alpha = 0.4)   + theme(title=element_text(size=20), axis.title.x = element_text(size=20), axis.text.x=element_text(size=15)) + labs(x=expression(paste(E[T] ^{miss},"(GeV)")),y=expression(paste("# of events weighted to 20 ",fb^{-1})),title="All samples") + theme(legend.position=c(0.85,0.8),  legend.text=element_text(size=15), legend.background = element_rect(fill=alpha('white',0.00001)))
ggplot(data=subset(d,sel==T),aes(x=met_pt)) + geom_histogram(data=subset(d,sel==T),breaks=seq(0,800,40),aes(fill=sample,y=..density..),alpha = 0.4) + geom_histogram(data=subset(mh,sel==T),breaks=seq(0,800,40),aes(y=..density..),alpha = 0.4)   + theme(title=element_text(size=20), axis.title.x = element_text(size=20), axis.text.x=element_text(size=15)) + labs(x=expression(paste(E[T] ^{miss},"(GeV)")),y="density",title="All samples") + theme(legend.position=c(0.85,0.8),  legend.text=element_text(size=15), legend.background = element_rect(fill=alpha('white',0.00001)))
ggplot(data=subset(d,sel==T),aes(x=H_mass,weight=genWeight)) + geom_histogram(breaks=seq(0,220,10),aes(color=sample,fill=sample)) + theme(title=element_text(size=20), axis.title.x = element_text(size=20), axis.text.x=element_text(size=15)) + labs(x=expression(paste(m[Higgs],"(GeV)")),y=expression(paste("# of events weighted to 20 ",fb^{-1})),title="All samples") + theme(legend.position=c(0.85,0.8),  legend.text=element_text(size=15), legend.background = element_rect(fill=alpha('white',0.00001)))
ggplot(data=subset(d,sel==T),aes(x=met_pt,weight=genWeight)) + geom_histogram(breaks=seq(0,800,40),aes(color=sample,fill=sample)) + theme(title=element_text(size=20), axis.title.x = element_text(size=20), axis.text.x=element_text(size=15)) + labs(x=expression(paste(E[T] ^{miss},"(GeV)")),y=expression(paste("# of events weighted to 20 ",fb^{-1})),title="All samples") + theme(legend.position=c(0.85,0.8),  legend.text=element_text(size=15), legend.background = element_rect(fill=alpha('white',0.00001)))
ggplot(data=subset(d,sel==T),aes(x=met_pt,weight=genWeight)) + geom_histogram(data=subset(d,sel==T),breaks=seq(0,800,40),aes(fill=sample,y=..density..),alpha = 0.4) + geom_histogram(data=subset(mh,sel==T),breaks=seq(0,800,40),aes(y=..density..),alpha = 0.4)   + theme(title=element_text(size=20), axis.title.x = element_text(size=20), axis.text.x=element_text(size=15)) + labs(x=expression(paste(E[T] ^{miss},"(GeV)")),y="density",title="All samples") + theme(legend.position=c(0.85,0.8),  legend.text=element_text(size=15), legend.background = element_rect(fill=alpha('white',0.00001)))
ggplot(data=subset(d,sel==T),aes(x=met_pt,weight=genWeight)) + geom_histogram(breaks=seq(0,800,40),aes(color=sample,fill=sample)) + theme(title=element_text(size=20), axis.title.x = element_text(size=20), axis.text.x=element_text(size=15)) + labs(x=expression(paste(E[T] ^{miss},"(GeV)")),y=expression(paste("# of events weighted to 20 ",fb^{-1})),title="All samples") + theme(legend.position=c(0.85,0.8),  legend.text=element_text(size=15), legend.background = element_rect(fill=alpha('white',0.00001)))
ggplot(data=subset(d,sel==T),aes(x=met_pt,weight=genWeight)) + geom_histogram(data=subset(d,sel==T),breaks=seq(0,800,40),aes(fill=sample),alpha = 0.4) + geom_histogram(data=subset(mh,sel==T),breaks=seq(0,800,40),alpha = 0.4)   + theme(title=element_text(size=20), axis.title.x = element_text(size=20), axis.text.x=element_text(size=15)) + labs(x=expression(paste(E[T] ^{miss},"(GeV)")),y="density",title="All samples") + theme(legend.position=c(0.85,0.8),  legend.text=element_text(size=15), legend.background = element_rect(fill=alpha('white',0.00001)))
ggplot(data=subset(d,sel==T),aes(x=met_pt)) + geom_histogram(data=subset(d,sel==T),breaks=seq(0,800,40),aes(fill=sample),alpha = 0.4) + geom_histogram(data=subset(mh,sel==T),breaks=seq(0,800,40),alpha = 0.4)   + theme(title=element_text(size=20), axis.title.x = element_text(size=20), axis.text.x=element_text(size=15)) + labs(x=expression(paste(E[T] ^{miss},"(GeV)")),y="density",title="All samples") + theme(legend.position=c(0.85,0.8),  legend.text=element_text(size=15), legend.background = element_rect(fill=alpha('white',0.00001)))
ggplot(data=subset(d,sel==T),aes(x=met_pt,weight=genWeight)) + geom_histogram(data=subset(d,sel==T),breaks=seq(0,800,40),aes(fill=sample),alpha = 0.4) + geom_histogram(data=subset(mh,sel==T),breaks=seq(0,800,40),alpha = 0.4)   + theme(title=element_text(size=20), axis.title.x = element_text(size=20), axis.text.x=element_text(size=15)) + labs(x=expression(paste(E[T] ^{miss},"(GeV)")),y="density",title="All samples") + theme(legend.position=c(0.85,0.8),  legend.text=element_text(size=15), legend.background = element_rect(fill=alpha('white',0.00001)))
ggplot(data=subset(d,sel==T),aes(x=met_pt,weight=genWeight)) + geom_histogram(data=subset(d,sel==T),breaks=seq(0,800,40),aes(fill=sample,y=..density..),alpha = 0.4) + geom_histogram(data=subset(mh,sel==T),breaks=seq(0,800,40),alpha = 0.4)   + theme(title=element_text(size=20), axis.title.x = element_text(size=20), axis.text.x=element_text(size=15)) + labs(x=expression(paste(E[T] ^{miss},"(GeV)")),y="density",title="All samples") + theme(legend.position=c(0.85,0.8),  legend.text=element_text(size=15), legend.background = element_rect(fill=alpha('white',0.00001)))
ggplot(data=subset(d,sel==T),aes(x=met_pt,weight=genWeight)) + geom_histogram(breaks=seq(0,800,40),aes(color=sample,fill=sample)) + theme(title=element_text(size=20), axis.title.x = element_text(size=20), axis.text.x=element_text(size=15)) + labs(x=expression(paste(E[T] ^{miss},"(GeV)")),y=expression(paste("# of events weighted to 20 ",fb^{-1})),title="All samples") + theme(legend.position=c(0.85,0.8),  legend.text=element_text(size=15), legend.background = element_rect(fill=alpha('white',0.00001)))
ggplot(data=subset(d,sel==T),aes(x=met_pt,weight=genWeight)) + geom_histogram(breaks=seq(0,800,40),aes(color=sample,fill=sample,y=..density..)) + theme(title=element_text(size=20), axis.title.x = element_text(size=20), axis.text.x=element_text(size=15)) + labs(x=expression(paste(E[T] ^{miss},"(GeV)")),y=expression(paste("# of events weighted to 20 ",fb^{-1})),title="All samples") + theme(legend.position=c(0.85,0.8),  legend.text=element_text(size=15), legend.background = element_rect(fill=alpha('white',0.00001)))
ggplot(data=subset(d,sel==T),aes(x=met_pt,weight=genWeight)) + geom_histogram(breaks=seq(0,800,40),aes(color=sample,fill=sample)) + theme(title=element_text(size=20), axis.title.x = element_text(size=20), axis.text.x=element_text(size=15)) + labs(x=expression(paste(E[T] ^{miss},"(GeV)")),y=expression(paste("# of events weighted to 20 ",fb^{-1})),title="All samples") + theme(legend.position=c(0.85,0.8),  legend.text=element_text(size=15), legend.background = element_rect(fill=alpha('white',0.00001)))
ggplot(data=subset(d,sel==T),aes(x=met_pt,weight=genWeight)) + geom_histogram(data=subset(d,sel==T),breaks=seq(0,800,40),aes(fill=sample,y=..density..),alpha = 0.4) + geom_histogram(data=subset(mh,sel==T),breaks=seq(0,800,40),alpha = 0.4)   + theme(title=element_text(size=20), axis.title.x = element_text(size=20), axis.text.x=element_text(size=15)) + labs(x=expression(paste(E[T] ^{miss},"(GeV)")),y="density",title="All samples") + theme(legend.position=c(0.85,0.8),  legend.text=element_text(size=15), legend.background = element_rect(fill=alpha('white',0.00001)))
ggplot(data=subset(d,sel==T),aes(x=met_pt,weight=genWeight)) + geom_histogram(data=subset(d,sel==T),breaks=seq(0,800,40),aes(y=..density..),alpha = 0.4) + geom_histogram(data=subset(mh,sel==T),breaks=seq(0,800,40),alpha = 0.4)   + theme(title=element_text(size=20), axis.title.x = element_text(size=20), axis.text.x=element_text(size=15)) + labs(x=expression(paste(E[T] ^{miss},"(GeV)")),y="density",title="All samples") + theme(legend.position=c(0.85,0.8),  legend.text=element_text(size=15), legend.background = element_rect(fill=alpha('white',0.00001)))
ggplot(data=subset(d,sel==T),aes(x=met_pt,weight=genWeight)) + geom_histogram(data=subset(d,sel==T),breaks=seq(0,800,40),aes(y=..density..),alpha = 0.4) + geom_histogram(data=subset(mh,sel==T),breaks=seq(0,800,40),alpha = 0.0001,color=green,aes(y=..density..))   + theme(title=element_text(size=20), axis.title.x = element_text(size=20), axis.text.x=element_text(size=15)) + labs(x=expression(paste(E[T] ^{miss},"(GeV)")),y="density",title="All samples") + theme(legend.position=c(0.85,0.8),  legend.text=element_text(size=15), legend.background = element_rect(fill=alpha('white',0.00001)))
ggplot(data=subset(d,sel==T),aes(x=met_pt,weight=genWeight)) + geom_histogram(data=subset(d,sel==T),breaks=seq(0,800,40),aes(y=..density..),alpha = 0.4) + geom_histogram(data=subset(mh,sel==T),breaks=seq(0,800,40),alpha = 0.0001,color="red",aes(y=..density..))   + theme(title=element_text(size=20), axis.title.x = element_text(size=20), axis.text.x=element_text(size=15)) + labs(x=expression(paste(E[T] ^{miss},"(GeV)")),y="density",title="All samples") + theme(legend.position=c(0.85,0.8),  legend.text=element_text(size=15), legend.background = element_rect(fill=alpha('white',0.00001)))
ggplot(data=subset(d,sel==T),aes(x=met_pt,weight=genWeight)) + geom_histogram(data=subset(d,sel==T),breaks=seq(0,800,40),aes(y=..density..),alpha = 0.4) + geom_histogram(data=subset(mh,sel==T),breaks=seq(0,800,40),alpha = 0.0001,color="red",aes(y=..density..))   + theme(title=element_text(size=20), axis.title.x = element_text(size=20), axis.text.x=element_text(size=15)) + labs(x=expression(paste(E[T] ^{miss},"(GeV)")),y="density",title="All samples vs. signal") + theme(legend.position=c(0.85,0.8),  legend.text=element_text(size=15), legend.background = element_rect(fill=alpha('white',0.00001)))
dev.copy(svg,"allVSsig.svg")
dev.off()
(ttp)
n1<-rPlot(rate ~ mass, data = d, type = "scatterChart")
require(rCharts)
n1<-rPlot(rate ~ mass, data = d, type = "scatterChart")
mass <- c(1,     10,    20,    30,    40,    50,    60)
rate <- c(0.126, 0.122, 0.108, 0.085, 0.057, 0.027, 0.003)
n1<-rPlot(rate ~ mass, data = d, type = "scatterChart")
d <- data.frame(mass,rate)
d
n1<-rPlot(rate ~ mass, data = d, type = "scatterChart")
n1$show('inline')
source("plot.R")
qcd100  <- read.csv(file='Step3_QCDHT100.csv', header=T,sep=',')
qcd250  <- read.csv(file='Step3_QCDHT250.csv', header=T,sep=',')
qcd500  <- read.csv(file='Step3_QCDHT500.csv', header=T,sep=',')
qcd1000 <- read.csv(file='Step3_QCDHT1000.csv',header=T,sep=',')
t_t     <- read.csv(file='Step3_T_t.csv',      header=T,sep=',')
tbar_t  <- read.csv(file='Step3_Tbar_t.csv',   header=T,sep=',')
t_tw    <- read.csv(file='Step3_T_tW.csv',     header=T,sep=',')
tbar_tw <- read.csv(file='Step3_Tbar_tW.csv',  header=T,sep=',')
t_s     <- read.csv(file='Step3_T_s.csv',      header=T,sep=',')
tbar_s  <- read.csv(file='Step3_Tbar_s.csv',   header=T,sep=',')
tt      <- read.csv(file='Step3_TTMadv2.csv',  header=T,sep=',')
hznn    <- read.csv(file='Step3_ZnnH125.csv',  header=T,sep=',')
zj100   <- read.csv(file='Step3_ZJetsHT100.csv',header=T,sep=',')
zj200   <- read.csv(file='Step3_ZJetsHT200.csv',header=T,sep=',')
zj400   <- read.csv(file='Step3_ZJetsHT400.csv',header=T,sep=',')
zj600   <- read.csv(file='Step3_ZJetsHT600.csv',header=T,sep=',')
wj100   <- read.csv(file='Step3_WJetsHT100.csv',header=T,sep=',')
wj200   <- read.csv(file='Step3_WJetsHT200.csv',header=T,sep=',')
wj400   <- read.csv(file='Step3_WJetsHT400.csv',header=T,sep=',')
wj600   <- read.csv(file='Step3_WJetsHT600.csv',header=T,sep=',')
wh      <- read.csv(file='Step3_WlnH125.csv',   header=T,sep=',')
monoH   <- read.csv(file='Step3_monoH.csv',     header=T,sep=',')
tt      <- read.csv(file='Step3_TTPythia8.csv',  header=T,sep=',')
source("funcs.R")
d <- subset(tt,hJidx.0.<5 & hJidx.1.<5)
d$sel <- apply(d,1,select)
sum(d$sel)
source("funcs.R")
d <- subset(tt,hJidx.0.<5 & hJidx.1.<5)
d$sel <- apply(d,1,select)
sum(d$sel)
source("funcs.R")
d$sel <- apply(d,1,select)
sum(d$sel)
length(tt[tt$Vtype==4 & tt$met_pt>200,"evt"])
length(tt[tt$Vtype==4,"evt"])
length(d[d$Vtype==4,"evt"])
source("funcs.R")
d$sel <- apply(d,1,select)
sum(d$sel)
source("funcs.R")
d$sel <- apply(d,1,select)
sum(d$sel)
d <- subset(tt,hJidx.0.<5 & hJidx.1.<5)
d$sel <- apply(d,1,select)
sum(d$sel)
source("funcs.R")
d$sel <- apply(d,1,select)
sum(d$sel)
source("funcs.R")
d$sel <- apply(d,1,select)
sum(d$sel)
source("funcs.R")
d$sel <- apply(d,1,select)
sum(d$sel)
fg
require(slidify)
slidify("index.Rmd")
library(ggplot2)
library(scales)
load("dC.RData");
scale20fb <- 20000
gplot(data=subset(d,sel==T & sample=="ZnnH" ),aes(x=H_mass)) +
   geom_histogram( breaks=seq(0,200,10),color="steelblue",fill="steelblue") +
   theme( title=element_text(size=20), axis.title.x = element_text(size=20), axis.text.x=element_text(size=15)) +
   labs( x=expression(paste(m[Higgs],"(GeV)")),y="# of unweighted events",title=expression(paste("Z(",nu,nu,")H(bb) sample")) )
dev.copy(svg,"_hmCSel.svg")
dev.off()
ggplot( data=subset(d,sel==T), aes(x=H_mass,weight=genWeight*scale20fb) ) +
   geom_histogram( breaks=seq(0,210,10),aes(color=sample,fill=sample) ) +
   theme( title=element_text(size=20), axis.title.x = element_text(size=20), axis.text.x=element_text(size=15) ) +
   labs( x=expression(paste(m[Higgs],"(GeV)")),y=expression(paste("# of events weighted to 20 ",fb^{-1})),title="All samples") +
   theme(legend.position=c(0.85,0.8),  legend.text=element_text(size=15), legend.background = element_rect(fill=alpha('white',0.00001)))
dev.copy(svg,"_hmCAllSelWide.svg")
dev.off()
ggplot( data=subset(d,sel==T & sample=="ZnnH" ), aes(x=H_mass) ) +
   geom_histogram( breaks=seq(0,210,10), color="steelblue", fill="steelblue") +
   theme( title=element_text(size=20), axis.title.x=element_text(size=20), axis.text.x=element_text(size=15) ) +
   labs( x=expression(paste(m[Higgs],"(GeV)")),y="# of unweighted events",title=expression(paste("Z(",nu,nu,")H(bb) sample")) )
dev.copy(svg,"_hmCSelWide.svg")
dev.off()
ggplot( data=subset(d,sel==T), aes( x=met_pt, weight=genWeight*scale20fb )) +
   geom_histogram( data=subset(d, sel==T), breaks=seq(0,800,40), aes(y=..density..), alpha = 0.4 ) +
   geom_histogram( data=subset(d, sel==T & name=="monoH"), breaks=seq(0,800,40), alpha = 0.0001, color="red", aes(y=..density..)) +
   theme( title=element_text(size=20), axis.title.x=element_text(size=20), axis.text.x=element_text(size=15)) +
   theme( legend.position=c(0.85,0.8), legend.text=element_text(size=15), legend.background=element_rect(fill=alpha('white',0.00001))) +
   labs( x=expression(paste(E[T] ^{miss},"(GeV)")),y="density",title="All samples vs. signal" )
dev.copy(svg,"_allCVSsig.svg")
dev.off()
